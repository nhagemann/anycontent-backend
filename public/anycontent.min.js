/*! anycontent 2023-07-08 */

function cmck_modal_id(e,t,i){e="#"+e,$(e).off("shown.bs.modal"),$(e).on("shown.bs.modal",function(){"function"==typeof i&&i()}),void 0!==t&&($(e).removeData(),$(e+" .modal-header").html(""),$(e+" .modal-body").html(""),$(e+" .modal-footer").html("")),$(e).appendTo("body"),$(e).modal({keyboard:!0}),$(e).load(t)}function cmck_modal(e,t){cmck_modal_id("modal_edit",e,t)}function cmck_modal_id_hide(e){e="#"+e,$(e).modal("hide")}function cmck_modal_hide(){cmck_modal_id_hide("modal_edit")}function cmck_modal_set_property(e,t){$("#form_edit [name="+e+"]").val(t)}function cmck_set_var(e,t){"object"!=typeof $.cmck&&($.cmck={}),$.cmck[e]=t}function cmck_get_var(e,t){return $.cmck[e]}function cmck_trigger_change(i){$(i).trigger("change"),$("iframe").each(function(e,t){"function"==typeof t.contentWindow.cmck_sequence_trigger_change&&t.contentWindow.cmck_sequence_trigger_change(i)})}function cmck_message_info(e){$("#messages").html('<div class="alert alert-info">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_message_alert(e){$("#messages").html('<div class="alert alert-warning">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_message_error(e){$("#messages").html('<div class="alert alert-danger">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_get_cookie(e){var t=window.document.cookie.split(e+"=");if(2==t.length)return t.pop().split(";").shift()}function cmck_delete_cookie(e){document.cookie=encodeURIComponent(e)+"=deleted; expires="+new Date(0).toUTCString()}function cmck_document(){return document}function cmck_sequence_trigger_change(e){$(e).trigger("change")}$(function(){$.widget("custom.autocompleteCat",$.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items","> :not(.ui-autocomplete-category)")},_renderMenu:function(o,e){var n=this,a="";$.each(e,function(e,t){var i;t.category!=a&&(void 0!==t.category&&o.append("<li class='ui-autocomplete-category'>"+t.category+"</li>"),a=t.category),i=n._renderItemData(o,t),t.category&&i.attr("aria-label",t.category+" : "+t.label)})}})}),$(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":$(".formelement-popover").popover({html:!0}),$(".formelement-tooltip").popover({html:!0})}}),$(document).ready(function(){}),$(document).on("cmck",function(e,t){switch(t.type){case"editform.setProperty":$("#form_edit [name="+t.property+"]").val(t.value),1==t.save&&0==parseInt($("#form_edit").attr("data-event-countdown"))&&$("#form_edit").submit()}}),$(document).ready(function(){$("#form_edit_button_save_options a").click(function(){return $("#form_edit_button_save").removeClass("open"),$("#form_edit_button_save input:first").attr("value",$(this).text()),$("#form_edit_button_save_operation").attr("value",$(this).attr("data-operation")),!1}),$("#form_edit_button_submit").click(function(){return $.event.trigger("cmck",{type:"editform.Save"}),$("#form_edit").submit(),!1}),$("#form_edit").submit(function(){return countdown=parseInt($("#form_edit").attr("data-event-countdown")),0==countdown&&(counterrors=0,$(".form-group.mandatory").each(function(){$(this).removeClass("has-error"),idFormelement=$(this).attr("data-formelement"),val="",$('[id^="'+idFormelement+'"]').each(function(){val+=$(this).val().trim(),console.log(val)}),""==val&&($(this).addClass("has-error"),counterrors++)}),0<counterrors?cmck_message_alert("Please fill in all required fields."):($.blockUI({message:null}),$.post($("#form_edit").attr("action"),$("#form_edit").serialize()).fail(function(e){cmck_message_error("Failed to save record. Please try again later or contact your administrator."),$.unblockUI()}).done(function(e){if(null!=e.success){if(1==e.success)return location.href=e.redirect,!1;if(null!=e.message){if(null!=e.error&&1==e.error?cmck_message_error(e.message):cmck_message_alert(e.message),null!=e.properties)for(i=0;i<e.properties.length;i++)property=e.properties[i],input=$('input[name="'+property+'"]'),id=input.attr("id"),$('div.form-group[data-formelement="'+id+'"]').addClass("has-error");return $.unblockUI(),!1}}cmck_message_error("Failed to save record. Please try again later or contact your administrator."),$.unblockUI()})),!1)}),$(".button_delete").click(function(){var t=$(this).attr("href");return bootbox.confirm("Are you sure?",function(e){e&&(document.location=t)}),!1}),$("#form_edit_button_transfer").click(function(){return cmck_modal($(this).attr("href")),!1}),$(document).keydown(function(e){return"115"!=e.which&&"83"!=e.which||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),$("#form_edit_button_submit").click(),!1)}),$.event.trigger("cmck",{type:"editForm.init"})}),function(a){a.fn.cmck_editsequence=function(){var e=!0,o=function(){init=0,a(".sequence-item").each(function(){a(this).height()>init&&(init=a(this).height())}),c=a("div.sequence-item").length,init+=35*c,c=a("ul.sequence-add-item").first().find("li").length,init+=40*c,init+=50,h=Math.max(200,init),iframe="#form_edit_sequence_"+a("#form_sequence").attr("data-property")+"_iframe",e?(a(iframe,window.parent.document).height(h),e=!1):a(iframe,window.parent.document).animate({height:h+"px"},500)};a(document).on("cmck",function(e,t){var i;switch(t.type){case"sequenceForm.init":case"sequenceForm.refresh":"sequenceForm.refresh"==t.type&&(a(".sequence-accordion").accordion("destroy"),a(".sequence-add-item li a").off("click"),a(".sequence-remove-item").off("click"),a(".sequence-accordion").sortable("refresh")),a(".sequence-accordion").accordion({header:".accordionTitle",collapsible:!0,heightStyle:"content",active:parseInt(a("#form_sequence").attr("data-active-item")),activate:function(){o()},animated:"fastslide"}),"sequenceForm.init"==t.type&&a(".sequence-accordion").sortable({axis:"y",handle:".accordionTitle",stop:function(e,t){t.item.children(".accordionTitle").triggerHandler("focusout")}}),a(".sequence-add-item li a").click(function(){insert=a(this).attr("data-insert"),i=a(this).closest("ul").attr("data-item"),a.event.trigger("cmck",{type:"sequenceForm.add",insert:insert,item:i})}),a(".sequence-remove-item").click(function(){i=a(this).attr("data-item"),a.event.trigger("cmck",{type:"sequenceForm.remove",item:i})}),o();break;case"sequenceForm.add":count=parseInt(a("#form_sequence").attr("data-count"))+1,a("#form_sequence").attr("data-count",count),a.get(a("#form_sequence").attr("data-action-add")+"?insert="+t.insert+"&count="+count,function(e){i=t.item,0<parseInt(i)?(a("#form_sequence_item_"+i).after(e),n=a("div.sequence-item").index(a("#form_sequence_item_"+i))+1):(a(".sequence-accordion").append(e),n=a("div.sequence-item").length-1),a("#form_sequence").attr("data-active-item",n),a.event.trigger("cmck",{type:"sequenceForm.refresh"})});break;case"sequenceForm.remove":i=parseInt(t.item),n=a("div.sequence-item").index(a("#form_sequence_item_"+i)),a("#form_sequence_item_"+i).remove(),n==a("div.sequence-item").length&&(n-=1),a("#form_sequence").attr("data-active-item",n),a.event.trigger("cmck",{type:"editForm.init",refresh:!0})}}),a.event.trigger("cmck",{type:"sequenceForm.init"})},a(document).ready(function(){a(document).cmck_editsequence()})}(jQuery),function(i){i(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":i(".datepicker").each(function(){i(this).datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",showWeek:!1,firstDay:1,numberOfMonths:1,showButtonPanel:!1})})}})}(jQuery),function(o){o.fn.cmck_fe_email=function(){var i=function(e){if(o(this).removeClass("alert-success"),o(this).removeClass("alert-danger"),email=o(this).val(),""!=email){var t=o(this);i=email,/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i)?(t.addClass("alert-success"),t.removeClass("alert-danger")):(t.addClass("alert-danger"),t.removeClass("alert-success"))}var i};o(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":o("div.formelement-email input").each(function(){val=o(this).val(),o(this).on("focus",i),o(this).on("blur",i)})}})},o(document).cmck_fe_email()}(jQuery),function(o){o.fn.cmck_fe_link=function(){var i=function(e){if(o(this).removeClass("alert-success"),o(this).removeClass("alert-danger"),url=o(this).val(),""!=url){var t=o(this);o.ajax({url:"/anycontent/formelement/link/check?url="+url,success:function(e){t.removeClass("alert-success"),t.removeClass("alert-warning"),t.removeClass("alert-danger"),200==e?t.addClass("alert-success"):400<e||0===e?t.addClass("alert-danger"):t.addClass("alert-warning")}})}};o(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":o("div.formelement-link input").each(function(){o(this).off("blur"),o(this).on("blur",i)})}})},o(document).cmck_fe_link()}(jQuery),function(i){i(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":i(".formelement-password input[type=text]").each(function(){i(this).change(function(){i(this).next("input[type=hidden]").val(1)})}),i(".formelement-password-generate-button").each(function(){i(this).click(function(){target=i(this).attr("data-target"),i(target).val(Math.random().toString(36).slice(-8)),i(target).next("input[type=hidden]").val(1)})}),i(".formelement-password-clear-button").each(function(){i(this).click(function(){target=i(this).attr("data-target"),i(target).val(""),i(target).next("input[type=hidden]").val(1),alert("Password cleared.")})})}})}(jQuery),function(i){i(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":i(".formelement-color input").minicolors({control:"wheel",letterCase:"uppercase",theme:"bootstrap"}),i(".formelement-color select").on("change",function(){value=i(this).val(),value.replace(/[^0-9A-F]/g,""),target=i(this).attr("data-target"),i("#"+target).minicolors("value",value)})}})}(jQuery),$(".file-select-item").click(function(){var e=$(this).attr("data-src");input=parent.cmck_get_var("fe_file_property"),$(input).val(e).trigger("change"),top.cmck_trigger_change(input),parent.cmck_modal_hide()}),$(document).ready(function(){$("#form_files_button_create_folder").click(function(){return $("#modal_files_create_folder").modal({}),!1}),$("#form_files_button_upload_file").click(function(){return $("#modal_files_upload_file").modal({}),!1}),$("#form_files_button_delete_folder").click(function(){return $("#modal_files_delete_folder").modal({}),!1}),$(".files-file-zoom").click(function(){$("#modal_files_file_zoom_title").html($(this).attr("data-title")),$("#modal_files_file_zoom_iframe").attr("src",$(this).attr("href"));return $("#modal_files_file_zoom").modal({keyboard:!0}),!1}),$(".files-file-edit").click(function(){$("#modal_files_file_original_id").val($(this).attr("data-title")),$("#modal_files_file_rename_id").val($(this).attr("data-title"));return $("#modal_files_file_edit").modal({keyboard:!0}),!1}),$(".files-delete-file").click(function(){$("#modal_files_file_delete_title").html($(this).attr("data-title")),$("#modal_files_file_delete_id").val($(this).attr("data-title"));return $("#modal_files_delete_file").modal({keyboard:!0}),!1})}),$(document).ready(function(){$(document).on("cmck",function(e,t){switch(t.type){case"editform.Save":$(".sequence-iframe").each(function(){var t=$(this).contents().find("#form_sequence");$("#form_edit").attr("data-event-countdown",parseInt($("#form_edit").attr("data-event-countdown"))+1),$.post($(t).attr("action"),$(t).serialize(),function(e){$("#form_edit").attr("data-event-countdown",parseInt($("#form_edit").attr("data-event-countdown"))-1),$.event.trigger("cmck",{type:"editform.setProperty",property:$(t).attr("data-property"),value:JSON.stringify(e.sequence),save:!0})},"json")})}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(k){"use strict";function i(e){var t=e.parent();e.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"),t.before(e).remove()}function o(e){var t=e.parent(),i=t.find(".minicolors-panel"),o=e.data("minicolors-settings");!e.data("minicolors-initialized")||e.prop("disabled")||t.hasClass("minicolors-inline")||t.hasClass("minicolors-focus")||(n(),t.addClass("minicolors-focus"),i.animate?i.stop(!0,!0).fadeIn(o.showSpeed,function(){o.show&&o.show.call(e.get(0))}):(i.show(),o.show&&o.show.call(e.get(0))))}function n(){k(".minicolors-focus").each(function(){var e=k(this),t=e.find(".minicolors-input"),i=e.find(".minicolors-panel"),o=t.data("minicolors-settings");i.animate?i.fadeOut(o.hideSpeed,function(){o.hide&&o.hide.call(t.get(0)),e.removeClass("minicolors-focus")}):(i.hide(),o.hide&&o.hide.call(t.get(0)),e.removeClass("minicolors-focus"))})}function a(e,t,i){var o,n,a,r,s,c=e.parents(".minicolors").find(".minicolors-input"),l=c.data("minicolors-settings"),d=e.find("[class$=-picker]"),m=e.offset().left,u=e.offset().top,h=Math.round(t.pageX-m),f=Math.round(t.pageY-u),p=i?l.animationSpeed:0;t.originalEvent.changedTouches&&(h=t.originalEvent.changedTouches[0].pageX-m,f=t.originalEvent.changedTouches[0].pageY-u),h<0&&(h=0),f<0&&(f=0),h>e.width()&&(h=e.width()),f>e.height()&&(f=e.height()),e.parent().is(".minicolors-slider-wheel")&&d.parent().is(".minicolors-grid")&&(o=75-h,n=75-f,a=Math.sqrt(o*o+n*n),(r=Math.atan2(n,o))<0&&(r+=2*Math.PI),75<a&&(h=(a=75)-75*Math.cos(r),f=75-75*Math.sin(r)),h=Math.round(h),f=Math.round(f)),s={top:f+"px"},e.is(".minicolors-grid")&&(s.left=h+"px"),d.animate?d.stop(!0).animate(s,p,l.animationEasing,function(){g(c,e)}):(d.css(s),g(c,e))}function g(e,t){function i(e,t){var i,o;return e.length&&t?(i=e.offset().left,o=e.offset().top,{x:i-t.offset().left+e.outerWidth()/2,y:o-t.offset().top+e.outerHeight()/2}):null}var o,n,a,r,s,c,l,d=e.val(),m=e.attr("data-opacity"),u=e.parent(),h=e.data("minicolors-settings"),f=u.find(".minicolors-input-swatch"),p=u.find(".minicolors-grid"),g=u.find(".minicolors-slider"),v=u.find(".minicolors-opacity-slider"),_=p.find("[class$=-picker]"),y=g.find("[class$=-picker]"),b=v.find("[class$=-picker]"),k=i(_,p),$=i(y,g),w=i(b,v);if(t.is(".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider")){switch(h.control){case"wheel":r=p.width()/2-k.x,s=p.height()/2-k.y,c=Math.sqrt(r*r+s*s),(l=Math.atan2(s,r))<0&&(l+=2*Math.PI),75<c&&(c=75,k.x=69-75*Math.cos(l),k.y=69-75*Math.sin(l)),n=M(c/.75,0,100),d=T({h:o=M(180*l/Math.PI,0,360),s:n,b:a=M(100-Math.floor($.y*(100/g.height())),0,100)}),g.css("backgroundColor",T({h:o,s:n,b:100}));break;case"saturation":d=T({h:o=M(parseInt(k.x*(360/p.width()),10),0,360),s:n=M(100-Math.floor($.y*(100/g.height())),0,100),b:a=M(100-Math.floor(k.y*(100/p.height())),0,100)}),g.css("backgroundColor",T({h:o,s:100,b:a})),u.find(".minicolors-grid-inner").css("opacity",n/100);break;case"brightness":d=T({h:o=M(parseInt(k.x*(360/p.width()),10),0,360),s:n=M(100-Math.floor(k.y*(100/p.height())),0,100),b:a=M(100-Math.floor($.y*(100/g.height())),0,100)}),g.css("backgroundColor",T({h:o,s:n,b:100})),u.find(".minicolors-grid-inner").css("opacity",1-a/100);break;default:d=T({h:o=M(360-parseInt($.y*(360/g.height()),10),0,360),s:n=M(Math.floor(k.x*(100/p.width())),0,100),b:a=M(100-Math.floor(k.y*(100/p.height())),0,100)}),p.css("backgroundColor",T({h:o,s:100,b:100}))}q(e,d,m=h.opacity?parseFloat(1-w.y/v.height()).toFixed(2):1)}else f.find("span").css({backgroundColor:d,opacity:String(m)}),C(e,d,m)}function q(e,t,i){var o,n=e.parent(),a=e.data("minicolors-settings"),r=n.find(".minicolors-input-swatch");a.opacity&&e.attr("data-opacity",i),t="rgb"===a.format?(o=S(t)?F(t,!0):j(w(t,!0)),i=""===e.attr("data-opacity")?1:M(parseFloat(e.attr("data-opacity")).toFixed(2),0,1),!isNaN(i)&&a.opacity||(i=1),e.minicolors("rgbObject").a<=1&&o&&a.opacity?"rgba("+o.r+", "+o.g+", "+o.b+", "+parseFloat(i)+")":"rgb("+o.r+", "+o.g+", "+o.b+")"):(S(t)&&(t=z(t)),$(t,a.letterCase)),e.val(t),r.find("span").css({backgroundColor:t,opacity:String(i)}),C(e,t,i)}function m(e,t){var i,o,n,a,r,s,c,l,d,m,u=e.parent(),h=e.data("minicolors-settings"),f=u.find(".minicolors-input-swatch"),p=u.find(".minicolors-grid"),g=u.find(".minicolors-slider"),v=u.find(".minicolors-opacity-slider"),_=p.find("[class$=-picker]"),y=g.find("[class$=-picker]"),b=v.find("[class$=-picker]");switch(S(e.val())?(i=z(e.val()),(r=M(parseFloat(I(e.val())).toFixed(2),0,1))&&e.attr("data-opacity",r)):i=$(w(e.val(),!0),h.letterCase),i||(i=$(x(h.defaultValue,!0),h.letterCase)),o=function(e){var t=function(e){var t={h:0,s:0,b:0},i=Math.min(e.r,e.g,e.b),o=Math.max(e.r,e.g,e.b),n=o-i;t.b=o,t.s=0!==o?255*n/o:0,0!==t.s?e.r===o?t.h=(e.g-e.b)/n:e.g===o?t.h=2+(e.b-e.r)/n:t.h=4+(e.r-e.g)/n:t.h=-1;t.h*=60,t.h<0&&(t.h+=360);return t.s*=100/255,t.b*=100/255,t}(j(e));0===t.s&&(t.h=360);return t}(i),a=h.keywords?k.map(h.keywords.split(","),function(e){return e.toLowerCase().trim()}):[],s=""!==e.val()&&-1<k.inArray(e.val().toLowerCase(),a)?$(e.val()):S(e.val())?F(e.val()):i,t||e.val(s),h.opacity&&(n=""===e.attr("data-opacity")?1:M(parseFloat(e.attr("data-opacity")).toFixed(2),0,1),isNaN(n)&&(n=1),e.attr("data-opacity",n),f.find("span").css("opacity",String(n)),l=M(v.height()-v.height()*n,0,v.height()),b.css("top",l+"px")),"transparent"===e.val().toLowerCase()&&f.find("span").css("opacity",String(0)),f.find("span").css("backgroundColor",i),h.control){case"wheel":d=M(Math.ceil(.75*o.s),0,p.height()/2),m=o.h*Math.PI/180,c=M(75-Math.cos(m)*d,0,p.width()),l=M(75-Math.sin(m)*d,0,p.height()),_.css({top:l+"px",left:c+"px"}),l=150-o.b/(100/p.height()),""===i&&(l=0),y.css("top",l+"px"),g.css("backgroundColor",T({h:o.h,s:o.s,b:100}));break;case"saturation":c=M(5*o.h/12,0,150),l=M(p.height()-Math.ceil(o.b/(100/p.height())),0,p.height()),_.css({top:l+"px",left:c+"px"}),l=M(g.height()-o.s*(g.height()/100),0,g.height()),y.css("top",l+"px"),g.css("backgroundColor",T({h:o.h,s:100,b:o.b})),u.find(".minicolors-grid-inner").css("opacity",o.s/100);break;case"brightness":c=M(5*o.h/12,0,150),l=M(p.height()-Math.ceil(o.s/(100/p.height())),0,p.height()),_.css({top:l+"px",left:c+"px"}),l=M(g.height()-o.b*(g.height()/100),0,g.height()),y.css("top",l+"px"),g.css("backgroundColor",T({h:o.h,s:o.s,b:100})),u.find(".minicolors-grid-inner").css("opacity",1-o.b/100);break;default:c=M(Math.ceil(o.s/(100/p.width())),0,p.width()),l=M(p.height()-Math.ceil(o.b/(100/p.height())),0,p.height()),_.css({top:l+"px",left:c+"px"}),l=M(g.height()-o.h/(360/g.height()),0,g.height()),y.css("top",l+"px"),p.css("backgroundColor",T({h:o.h,s:100,b:100}))}e.data("minicolors-initialized")&&C(e,s,n)}function C(e,t,i){var o,n,a,r=e.data("minicolors-settings"),s=e.data("minicolors-lastChange");if(!s||s.value!==t||s.opacity!==i){if(e.data("minicolors-lastChange",{value:t,opacity:i}),r.swatches&&0!==r.swatches.length){for(o=S(t)?F(t,!0):j(t),n=-1,a=0;a<r.swatches.length;++a)if(o.r===r.swatches[a].r&&o.g===r.swatches[a].g&&o.b===r.swatches[a].b&&o.a===r.swatches[a].a){n=a;break}e.parent().find(".minicolors-swatches .minicolors-swatch").removeClass("selected"),-1!==n&&e.parent().find(".minicolors-swatches .minicolors-swatch").eq(a).addClass("selected")}r.change&&(r.changeDelay?(clearTimeout(e.data("minicolors-changeTimeout")),e.data("minicolors-changeTimeout",setTimeout(function(){r.change.call(e.get(0),t,i)},r.changeDelay))):r.change.call(e.get(0),t,i)),e.trigger("change").trigger("input")}}function $(e,t){return"uppercase"===t?e.toUpperCase():e.toLowerCase()}function w(e,t){return(e=e.replace(/^#/g,"")).match(/^[A-F0-9]{3,6}/gi)?3!==e.length&&6!==e.length?"":(3===e.length&&t&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),"#"+e):""}function F(e,t){var i=e.replace(/[^\d,.]/g,"").split(",");return i[0]=M(parseInt(i[0],10),0,255),i[1]=M(parseInt(i[1],10),0,255),i[2]=M(parseInt(i[2],10),0,255),void 0!==i[3]&&(i[3]=M(parseFloat(i[3],10),0,1)),t?void 0!==i[3]?{r:i[0],g:i[1],b:i[2],a:i[3]}:{r:i[0],g:i[1],b:i[2]}:void 0!==i[3]&&i[3]<=1?"rgba("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")":"rgb("+i[0]+", "+i[1]+", "+i[2]+")"}function x(e,t){return S(e)?F(e):w(e,t)}function M(e,t,i){return e<t&&(e=t),i<e&&(e=i),e}function S(e){var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return!(!t||4!==t.length)}function I(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===e.length?e[4]:"1"}function z(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}function u(e){var i=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return k.each(i,function(e,t){1===t.length&&(i[e]="0"+t)}),"#"+i.join("")}function T(e){return u(function(e){var t={},i=Math.round(e.h),o=Math.round(255*e.s/100),n=Math.round(255*e.b/100);if(0===o)t.r=t.g=t.b=n;else{var a=n,r=(255-o)*n/255,s=i%60*(a-r)/60;360===i&&(i=0),i<60?(t.r=a,t.b=r,t.g=r+s):i<120?(t.g=a,t.b=r,t.r=a-s):i<180?(t.g=a,t.r=r,t.b=r+s):i<240?(t.b=a,t.r=r,t.g=a-s):i<300?(t.b=a,t.g=r,t.r=r+s):i<360?(t.r=a,t.g=r,t.b=a-s):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}(e))}function j(e){return{r:(e=parseInt(-1<e.indexOf("#")?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}}k.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!1,position:"bottom",show:null,showSpeed:100,theme:"default",swatches:[]}},k.extend(k.fn,{minicolors:function(e,t){switch(e){case"destroy":return k(this).each(function(){i(k(this))}),k(this);case"hide":return n(),k(this);case"opacity":return void 0===t?k(this).attr("data-opacity"):(k(this).each(function(){m(k(this).attr("data-opacity",t))}),k(this));case"rgbObject":return function(e){var t,i=k(e).attr("data-opacity");if(S(k(e).val()))t=F(k(e).val(),!0);else{var o=w(k(e).val(),!0);t=j(o)}if(!t)return null;void 0!==i&&k.extend(t,{a:parseFloat(i)});return t}(k(this));case"rgbString":case"rgbaString":return function(e,t){var i,o=k(e).attr("data-opacity");if(S(k(e).val()))i=F(k(e).val(),!0);else{var n=w(k(e).val(),!0);i=j(n)}if(!i)return null;void 0===o&&(o=1);return t?"rgba("+i.r+", "+i.g+", "+i.b+", "+parseFloat(o)+")":"rgb("+i.r+", "+i.g+", "+i.b+")"}(k(this),"rgbaString"===e);case"settings":return void 0===t?k(this).data("minicolors-settings"):(k(this).each(function(){var e=k(this).data("minicolors-settings")||{};i(k(this)),k(this).minicolors(k.extend(!0,e,t))}),k(this));case"show":return o(k(this).eq(0)),k(this);case"value":return void 0===t?k(this).val():(k(this).each(function(){"object"==typeof t&&null!==t?(void 0!==t.opacity&&k(this).attr("data-opacity",M(t.opacity,0,1)),t.color&&k(this).val(t.color)):k(this).val(t),m(k(this))}),k(this));default:return"create"!==e&&(t=e),k(this).each(function(){!function(t,e){var i,o,n,a,r,s,c,l=k('<div class="minicolors" />'),d=k.minicolors.defaults;if(t.data("minicolors-initialized"))return;e=k.extend(!0,{},d,e),l.addClass("minicolors-theme-"+e.theme).toggleClass("minicolors-with-opacity",e.opacity),void 0!==e.position&&k.each(e.position.split(" "),function(){l.addClass("minicolors-position-"+this)});o="rgb"===e.format?e.opacity?"25":"20":e.keywords?"11":"7";t.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",e).prop("size",o).wrap(l).after('<div class="minicolors-panel minicolors-slider-'+e.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>'),e.inline||(t.after('<span class="minicolors-swatch minicolors-sprite minicolors-input-swatch"><span class="minicolors-swatch-color"></span></span>'),t.next(".minicolors-input-swatch").on("click",function(e){e.preventDefault(),t.trigger("focus")}));if((s=t.parent().find(".minicolors-panel")).on("selectstart",function(){return!1}).end(),e.swatches&&0!==e.swatches.length)for(s.addClass("minicolors-with-swatches"),n=k('<ul class="minicolors-swatches"></ul>').appendTo(s),c=0;c<e.swatches.length;++c)a="object"==typeof e.swatches[c]?(i=e.swatches[c].name,e.swatches[c].color):(i="",e.swatches[c]),a=S(r=a)?F(a,!0):j(w(a,!0)),k('<li class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></li>').attr("title",i).appendTo(n).data("swatch-color",r).find(".minicolors-swatch-color").css({backgroundColor:"transparent"!==r?u(a):"transparent",opacity:String(a.a)}),e.swatches[c]=a;e.inline&&t.parent().addClass("minicolors-inline");m(t,!1),t.data("minicolors-initialized",!0)}(k(this),t)}),k(this)}}}),k([document]).on("mousedown.minicolors touchstart.minicolors",function(e){k(e.target).parents().add(e.target).hasClass("minicolors")||n()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(e){var t=k(this);e.preventDefault(),k(e.delegateTarget).data("minicolors-target",t),a(t,e,!0)}).on("mousemove.minicolors touchmove.minicolors",function(e){var t=k(e.delegateTarget).data("minicolors-target");t&&a(t,e)}).on("mouseup.minicolors touchend.minicolors",function(){k(this).removeData("minicolors-target")}).on("click.minicolors",".minicolors-swatches li",function(e){e.preventDefault();var t=k(this),i=t.parents(".minicolors").find(".minicolors-input"),o=t.data("swatch-color");q(i,o,I(o)),m(i)}).on("mousedown.minicolors touchstart.minicolors",".minicolors-input-swatch",function(e){var t=k(this).parent().find(".minicolors-input");e.preventDefault(),o(t)}).on("focus.minicolors",".minicolors-input",function(){var e=k(this);e.data("minicolors-initialized")&&o(e)}).on("blur.minicolors",".minicolors-input",function(){var e,t,i,o,n,a=k(this),r=a.data("minicolors-settings");a.data("minicolors-initialized")&&(e=r.keywords?k.map(r.keywords.split(","),function(e){return e.toLowerCase().trim()}):[],n=""!==a.val()&&-1<k.inArray(a.val().toLowerCase(),e)?a.val():null===(i=S(a.val())?F(a.val(),!0):(t=w(a.val(),!0))?j(t):null)?r.defaultValue:"rgb"===r.format?r.opacity?F("rgba("+i.r+","+i.g+","+i.b+","+a.attr("data-opacity")+")"):F("rgb("+i.r+","+i.g+","+i.b+")"):u(i),o=r.opacity?a.attr("data-opacity"):1,"transparent"===n.toLowerCase()&&(o=0),a.closest(".minicolors").find(".minicolors-input-swatch > span").css("opacity",String(o)),a.val(n),""===a.val()&&a.val(x(r.defaultValue,!0)),a.val($(a.val(),r.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(e){var t=k(this);if(t.data("minicolors-initialized"))switch(e.which){case 9:n();break;case 13:case 27:n(),t.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var e=k(this);e.data("minicolors-initialized")&&m(e,!0)}).on("paste.minicolors",".minicolors-input",function(){var e=k(this);e.data("minicolors-initialized")&&setTimeout(function(){m(e,!0)},1)})}),$(document).ready(function(){$("#listing_filter select").change(function(){$("#listing_filter").submit()})}),$(document).ready(function(){$(".feedback .alert-success").delay(2e3).fadeOut(500),$(".feedback .alert-info").delay(2500).fadeOut(500),$(".feedback .alert-warning").delay(3e3).fadeOut(500),$(".feedback .alert-danger").delay(4500).fadeOut(500),$(".timeshift-blink").each(function(){var e=$(this);setInterval(function(){"hidden"==e.css("visibility")?e.css("visibility","visible"):e.css("visibility","hidden")},500)})}),$(document).ready(function(){$("ol.sortable-tree").nestedSortable({handle:"div",items:"li.sortable-item",toleranceElement:"> div",protectRoot:!0,opacity:.5,revert:100,tabSize:20,tolerance:"pointer",connectWith:".sortable-tree",relocate:function(){if(1<$("#sortable_tree_left > li").length)return!1;$("#list_root").removeClass("sortable-emptylist")}}),$("#form_sort_button_save").click(function(){$("ol.sortable-tree").nestedSortable({items:"li"}),nested=$("ol.sortable-tree").nestedSortable("toArray",{startDepthCount:0}),tree=[],$.each(nested,function(e,t){if(0<t.depth){var i={id:t.id,parent_id:t.parent_id};tree.push(i)}}),$.blockUI({message:null}),$("#form_sort_list").val(JSON.stringify(tree))})});