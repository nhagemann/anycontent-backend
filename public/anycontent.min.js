/*! anycontent 2023-06-30 */

function cmck_modal_id(e,t,i){e="#"+e,$(e).off("shown.bs.modal"),$(e).on("shown.bs.modal",function(){"function"==typeof i&&i()}),void 0!==t&&($(e).removeData(),$(e+" .modal-header").html(""),$(e+" .modal-body").html(""),$(e+" .modal-footer").html("")),$(e).appendTo("body"),$(e).modal({keyboard:!0}),$(e).load(t)}function cmck_modal(e,t){cmck_modal_id("modal_edit",e,t)}function cmck_modal_id_hide(e){e="#"+e,$(e).modal("hide")}function cmck_modal_hide(){cmck_modal_id_hide("modal_edit")}function cmck_modal_set_property(e,t){$("#form_edit [name="+e+"]").val(t)}function cmck_set_var(e,t){"object"!=typeof $.cmck&&($.cmck={}),$.cmck[e]=t}function cmck_get_var(e,t){return $.cmck[e]}function cmck_trigger_change(i){$(i).trigger("change"),$("iframe").each(function(e,t){"function"==typeof t.contentWindow.cmck_sequence_trigger_change&&t.contentWindow.cmck_sequence_trigger_change(i)})}function cmck_message_info(e){$("#messages").html('<div class="alert alert-info">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_message_alert(e){$("#messages").html('<div class="alert alert-warning">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_message_error(e){$("#messages").html('<div class="alert alert-danger">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_get_cookie(e){var t=window.document.cookie.split(e+"=");if(2==t.length)return t.pop().split(";").shift()}function cmck_delete_cookie(e){document.cookie=encodeURIComponent(e)+"=deleted; expires="+new Date(0).toUTCString()}function cmck_document(){return document}function cmck_sequence_trigger_change(e){$(e).trigger("change")}$(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":$(".formelement-popover").popover({html:!0}),$(".formelement-tooltip").popover({html:!0})}}),$(document).ready(function(){}),$(document).on("cmck",function(e,t){switch(t.type){case"editform.setProperty":$("#form_edit [name="+t.property+"]").val(t.value),1==t.save&&0==parseInt($("#form_edit").attr("data-event-countdown"))&&$("#form_edit").submit()}}),$(document).ready(function(){$("#form_edit_button_save_options a").click(function(){return $("#form_edit_button_save").removeClass("open"),$("#form_edit_button_save input:first").attr("value",$(this).text()),$("#form_edit_button_save_operation").attr("value",$(this).attr("data-operation")),!1}),$("#form_edit_button_submit").click(function(){return $.event.trigger("cmck",{type:"editform.Save"}),$("#form_edit").submit(),!1}),$("#form_edit").submit(function(){return countdown=parseInt($("#form_edit").attr("data-event-countdown")),0==countdown&&(counterrors=0,$(".form-group.mandatory").each(function(){$(this).removeClass("has-error"),idFormelement=$(this).attr("data-formelement"),val="",$('[id^="'+idFormelement+'"]').each(function(){val+=$(this).val().trim(),console.log(val)}),""==val&&($(this).addClass("has-error"),counterrors++)}),0<counterrors?cmck_message_alert("Please fill in all required fields."):($.blockUI({message:null}),$.post($("#form_edit").attr("action"),$("#form_edit").serialize()).fail(function(e){cmck_message_error("Failed to save record. Please try again later or contact your administrator."),$.unblockUI()}).done(function(e){if(null!=e.success){if(1==e.success)return location.href=e.redirect,!1;if(null!=e.message){if(null!=e.error&&1==e.error?cmck_message_error(e.message):cmck_message_alert(e.message),null!=e.properties)for(i=0;i<e.properties.length;i++)property=e.properties[i],input=$('input[name="'+property+'"]'),id=input.attr("id"),$('div.form-group[data-formelement="'+id+'"]').addClass("has-error");return $.unblockUI(),!1}}cmck_message_error("Failed to save record. Please try again later or contact your administrator."),$.unblockUI()})),!1)}),$(".button_delete").click(function(){var t=$(this).attr("href");return bootbox.confirm("Are you sure?",function(e){e&&(document.location=t)}),!1}),$("#form_edit_button_transfer").click(function(){return cmck_modal($(this).attr("href")),!1}),$(document).keydown(function(e){return"115"!=e.which&&"83"!=e.which||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),$("#form_edit_button_submit").click(),!1)}),$.event.trigger("cmck",{type:"editForm.init"})}),function(r){r.fn.cmck_editsequence=function(){var e=!0,o=function(){init=0,r(".sequence-item").each(function(){r(this).height()>init&&(init=r(this).height())}),c=r("div.sequence-item").length,init+=35*c,c=r("ul.sequence-add-item").first().find("li").length,init+=40*c,init+=50,h=Math.max(200,init),iframe="#form_edit_sequence_"+r("#form_sequence").attr("data-property")+"_iframe",e?(r(iframe,window.parent.document).height(h),e=!1):r(iframe,window.parent.document).animate({height:h+"px"},500)};r(document).on("cmck",function(e,t){var i;switch(t.type){case"sequenceForm.init":case"sequenceForm.refresh":"sequenceForm.refresh"==t.type&&(r(".sequence-accordion").accordion("destroy"),r(".sequence-add-item li a").off("click"),r(".sequence-remove-item").off("click"),r(".sequence-accordion").sortable("refresh")),r(".sequence-accordion").accordion({header:".accordionTitle",collapsible:!0,heightStyle:"content",active:parseInt(r("#form_sequence").attr("data-active-item")),activate:function(){o()},animated:"fastslide"}),"sequenceForm.init"==t.type&&r(".sequence-accordion").sortable({axis:"y",handle:".accordionTitle",stop:function(e,t){t.item.children(".accordionTitle").triggerHandler("focusout")}}),r(".sequence-add-item li a").click(function(){insert=r(this).attr("data-insert"),i=r(this).closest("ul").attr("data-item"),r.event.trigger("cmck",{type:"sequenceForm.add",insert:insert,item:i})}),r(".sequence-remove-item").click(function(){i=r(this).attr("data-item"),r.event.trigger("cmck",{type:"sequenceForm.remove",item:i})}),o();break;case"sequenceForm.add":count=parseInt(r("#form_sequence").attr("data-count"))+1,r("#form_sequence").attr("data-count",count),r.get(r("#form_sequence").attr("data-action-add")+"?insert="+t.insert+"&count="+count,function(e){i=t.item,0<parseInt(i)?(r("#form_sequence_item_"+i).after(e),n=r("div.sequence-item").index(r("#form_sequence_item_"+i))+1):(r(".sequence-accordion").append(e),n=r("div.sequence-item").length-1),r("#form_sequence").attr("data-active-item",n),r.event.trigger("cmck",{type:"sequenceForm.refresh"})});break;case"sequenceForm.remove":i=parseInt(t.item),n=r("div.sequence-item").index(r("#form_sequence_item_"+i)),r("#form_sequence_item_"+i).remove(),n==r("div.sequence-item").length&&(n-=1),r("#form_sequence").attr("data-active-item",n),r.event.trigger("cmck",{type:"editForm.init",refresh:!0})}}),r.event.trigger("cmck",{type:"sequenceForm.init"})},r(document).ready(function(){r(document).cmck_editsequence()})}(jQuery),$(document).ready(function(){$("#form_files_button_create_folder").click(function(){return $("#modal_files_create_folder").modal({}),!1}),$("#form_files_button_upload_file").click(function(){return $("#modal_files_upload_file").modal({}),!1}),$("#form_files_button_delete_folder").click(function(){return $("#modal_files_delete_folder").modal({}),!1}),$(".files-file-zoom").click(function(){$("#modal_files_file_zoom_title").html($(this).attr("data-title")),$("#modal_files_file_zoom_iframe").attr("src",$(this).attr("href"));return $("#modal_files_file_zoom").modal({keyboard:!0}),!1}),$(".files-file-edit").click(function(){$("#modal_files_file_original_id").val($(this).attr("data-title")),$("#modal_files_file_rename_id").val($(this).attr("data-title"));return $("#modal_files_file_edit").modal({keyboard:!0}),!1}),$(".files-delete-file").click(function(){$("#modal_files_file_delete_title").html($(this).attr("data-title")),$("#modal_files_file_delete_id").val($(this).attr("data-title"));return $("#modal_files_delete_file").modal({keyboard:!0}),!1})}),$(document).ready(function(){$(document).on("cmck",function(e,t){switch(t.type){case"editform.Save":$(".sequence-iframe").each(function(){var t=$(this).contents().find("#form_sequence");$("#form_edit").attr("data-event-countdown",parseInt($("#form_edit").attr("data-event-countdown"))+1),$.post($(t).attr("action"),$(t).serialize(),function(e){$("#form_edit").attr("data-event-countdown",parseInt($("#form_edit").attr("data-event-countdown"))-1),$.event.trigger("cmck",{type:"editform.setProperty",property:$(t).attr("data-property"),value:JSON.stringify(e.sequence),save:!0})},"json")})}})}),$(document).ready(function(){$("#listing_filter select").change(function(){$("#listing_filter").submit()})}),$(document).ready(function(){$(".feedback .alert-success").delay(2e3).fadeOut(500),$(".feedback .alert-info").delay(2500).fadeOut(500),$(".feedback .alert-warning").delay(3e3).fadeOut(500),$(".feedback .alert-danger").delay(4500).fadeOut(500),$(".timeshift-blink").each(function(){var e=$(this);setInterval(function(){"hidden"==e.css("visibility")?e.css("visibility","visible"):e.css("visibility","hidden")},500)})}),$(document).ready(function(){$("ol.sortable-tree").nestedSortable({handle:"div",items:"li.sortable-item",toleranceElement:"> div",protectRoot:!0,opacity:.5,revert:100,tabSize:20,tolerance:"pointer",connectWith:".sortable-tree",relocate:function(){if(1<$("#sortable_tree_left > li").length)return!1;$("#list_root").removeClass("sortable-emptylist")}}),$("#form_sort_button_save").click(function(){$("ol.sortable-tree").nestedSortable({items:"li"}),nested=$("ol.sortable-tree").nestedSortable("toArray",{startDepthCount:0}),tree=[],$.each(nested,function(e,t){if(0<t.depth){var i={id:t.id,parent_id:t.parent_id};tree.push(i)}}),$.blockUI({message:null}),$("#form_sort_list").val(JSON.stringify(tree))})});